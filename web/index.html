<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="data:;base64,iVBORw0KGgo="/> <!-- Fake favicon to stop requests -->
  <title>Pulse Duplicator Manager</title>
  <link rel="stylesheet" href="style.css">
  <script type="text/javascript" src="/eel.js"></script>
	<!--  main.js imported at the bottom  -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>

<body>
  <div class="topnav">
    <a class="active" id="manual-btn" onclick="change_mode('manual')">Manual testing</a>
    <a id="waveform-btn" onclick="change_mode('waveform')">Waveform manager</a>
  </div>

  <!--                            -->
  <!--  MANUAL TESTING INTERFACE  --> 
  <!--                            -->
  <div id="manual">
    <h2>Manual testing</h2>
    <p class="input-container">
      Open inflow valve 
      <span>
        <input type="range" min="0" max="100" id="inflow_r" 
          oninput="pubsub.publish('inflow', this.value)" />
        <input type="number" min="0" max="100" id="inflow_n" 
          oninput="pubsub.publish('inflow', this.value)" />
      </span>
    </p>
    <p class="input-container">
      Open outflow valve
      <span>
        <input type="range" min="0" max="100" id="outflow_r"
          oninput="pubsub.publish('outflow', this.value)" />
        <input type="number" min="0" max="100" id="outflow_n"
          oninput="pubsub.publish('outflow', this.value)" />
      </span>
    </p>
    <button onclick="toggle_LED('red')"> Toggle LED 1</button>
    <button onclick="toggle_LED('blue')"> Toggle LED 2</button>
  </div>

  <!--                             -->
  <!--  WAVEFORM TESTING INTERFACE -->
  <!--                             -->
  <div id="waveform" style="display: none;">

    <h2>Waveform manager</h2>
    
    <div class="flex-container" style="justify-content: space-between">

      <!--  Container for all rate and period inputs -->
      <div id="rate-and-period">
  
        <!--  Heart rate (bpm) input -->
        <p class="input-container">
          Heart rate (bpm):
          <span>
            <span class="range-labels">
              <input type="range" min="30" max="200" id="bpm_r"
                oninput="pubsub.publish('bpm', this.value)" />
              <label class="min label">30</label>
              <label class="max label">200</label>
            </span>
            <input type="number" min="30" max="200" id="bpm_n" 
              oninput="pubsub.publish('bpm', this.value)" />
      		  beats / min
          </span>
        </p>

        <!--  Heart rate (Hz)  -->
        <p class="input-container">
          Heart rate (Hz): 
          <span>
            <span class="range-labels">
              <input type="range" min="0.5" max="3.33" step="0.01" id="hz_r"
                oninput="pubsub.publish('bpm', this.value * 60)" />
              <label class="min label">0.50</label>
              <label class="max label">3.33</label>
            </span>
            <input type="number" min="0.67" max="1.67" step="0.01" id="hz_n"
              oninput="pubsub.publish('bpm', this.value * 60)" />
        		beats / sec
          </span>
        </p>

        <!--  Heart rate period (s)  -->
        <p class="input-container">
          Period (s):
          <span>
            <span class="range-labels">
              <input type="range" min="0.3" max="2" step="0.01" id="period_r"
                oninput="pubsub.publish('bpm', 60 / this.value )" />
              <label class="min label">0.3</label>
              <label class="max label">2</label>
            </span>
            <input type="number" min="0.3" max="2" step="0.01" id="period_n"
               oninput="pubsub.publish('bpm', 60 / this.value )" />
        		seconds
          </span>
        </p>

      </div> <!--  End rate and period container -->
  
      <!--  Container for pressures -->
      <div id="pressures">
  
        <!--  Diastole pressure input -->
        <p class="input-container">
          Diastole pressure:
          <span>
            <span class="range-labels">
              <input type="range" min="60" max="110" id="diastole_r" 
                oninput="pubsub.publish('diastole', this.value)" value="80"/>
              <label class="min label">60</label>
              <label class="max label" id="diastole_max">120</label>
            </span>
            <input type="number" min="60" max="110" id="diastole_n" 
              oninput="pubsub.publish('diastole', this.value)" value="80"/>
        		mmHg
          </span>
        </p>

        <!--  Systole pressure input  -->
        <p class="input-container">
          Systole pressure:
          <span>
            <span class="range-labels">
              <input type="range" min="90" max="210" id="systole_r" 
                oninput="pubsub.publish('systole', this.value)" value="120"/>
              <label class="min label" id="systole_min">9.0</label>
              <label class="max label">210</label>
            </span>
            <input type="number" min="90" max="210" id="systole_n" 
              oninput="pubsub.publish('systole', this.value)" value="120"/>
		        mmHg
          </span>
        </p>

      </div>  <!--  End pressure container  -->
    </div> <!--  End flex container  -->

    <!--  Button to toggle pulse  -->
    <p>
      <button onclick="start_pulse()" id="start-pulse"> &#9654; Start pulse</button>
      <button onclick="stop_pulse()" id="stop-pulse" style="display:none;"> &#9208; Stop pulse</button>
    </p>

    <!--  Waveform graph  -->
    <div id="graph-container">
      <canvas id="pulse-graph"></canvas>
    </div>      

  <div>
</body>

<script src="main.js"></script>
</html>
